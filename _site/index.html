<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      十字路口 &middot; 每天进步一点
    
  </title>

  <!-- CSS -->
  <!-- <link rel="stylesheet" href="/public/css/syntax.css"> -->
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/highlight.css">
  <!--<link rel="stylesheet" href="/public/css/pygments.css">-->
  <!--<link rel="stylesheet" href="/public/css/rouge.css">-->
  <link rel="stylesheet" href="/public/css/font-awesome.min.css">
  <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400"> -->

  <!-- Icons -->
  <!-- <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/img/apple-touch-icon-144-precomposed.png"> -->
  <link rel="shortcut icon" href="/public/img/tiger.jpg">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- livereload test -->
  <!--<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>-->

  <!-- audioplayer -->
  <script src="/public/js/jquery-1.11.1.js"></script>
  <script src="/public/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- <script src="/public/js/audioplayer/amazingaudioplayer.js"></script> -->
  <!-- <link rel="stylesheet" type="text/css" href="/public/css/audioplayer/initaudioplayer-1.css"> -->



</head>


  <body class="">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="sidebar-logo">
      <a href="/"><img src="/public/img/tiger.jpg"></a>
    </div>
    <p>不写博客的程序员不是好码农</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/"><i class="fa fa-home fa-fw"></i>&nbsp 主页·&nbspHome</a>
    <a class="sidebar-nav-item" href="/archive/"><i class="fa fa-file-text-o fa-fw"></i>&nbsp 归档·&nbspArchive</a>
    <a class="sidebar-nav-item" href="/category/"><i class="fa fa-book fa-fw"></i>&nbsp 分类·&nbspCategory</a>
    <a class="sidebar-nav-item" href="/tag/"><i class="fa fa-tags fa-fw"></i>&nbsp 标签·&nbspTag</a>
    <a class="sidebar-nav-item" href="/works/">works</a>
    <a class="sidebar-nav-item" href="/about/"><i class="fa fa-hand-o-right fa-fw"></i>&nbsp 关于·&nbspAbout</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2016. All rights reserved.
    </p>
  </div>
</div>



    

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <div class="masthead-title">
            <a href="/" title="Home">
              <span data-hover="tiger">十字路口</span>
            </a>
            <small>每天进步一点</small>
          </div>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <div class="post-heading">
        
          <img src="/public/img/other.jpg">
        
      <h1 class="post-title">
        <a class="post-title-home" href="/2016/08/11/test/">
          Test
        </a>
      </h1>
        <p class="post-info">
        
          转载
        
        </p>
        <span class="post-info"><i class="fa fa-calendar"></i>&nbsp2016/08/11  </span>
        <span class="post-info"><i class="fa fa-book"></i>&nbsp<a href="/category/index.html#"></a></span>
        <span class="post-info"><i class="fa fa-tags"></i>&nbsp<a href="/tag/index.html#"></a></span>  
        <span class="post-info"><a href="/tag/index.html#"></a></span>
        <span class="post-info"><a href="/tag/index.html#"></a></span>
    </div>
    <div class="post-content">
      
<hr />
<p>layout: post
author: wangxinghu
title: 坚持
category: c
tag: [a, b]
—</p>

<h3 id="testtttt">testtttt</h3>

      <div class="readmore">
        <a href="/2016/08/11/test/"><i class="fa fa-hand-o-right"></i>&nbsp阅读全文</a>
      </div>
    </div>
  </div>
  
  <div class="post">
    <div class="post-heading">
        
          <img src="/public/img/wangxinghu.jpg">
        
      <h1 class="post-title">
        <a class="post-title-home" href="/skill/2016/08/08/skill_point/">
          skill_point
        </a>
      </h1>
        <p class="post-info">
        
          wangxinghu原创
        
        </p>
        <span class="post-info"><i class="fa fa-calendar"></i>&nbsp2016/08/08  </span>
        <span class="post-info"><i class="fa fa-book"></i>&nbsp<a href="/category/index.html#skill">skill</a></span>
        <span class="post-info"><i class="fa fa-tags"></i>&nbsp<a href="/tag/index.html#skill">skill</a></span>  
        <span class="post-info"><a href="/tag/index.html#"></a></span>
        <span class="post-info"><a href="/tag/index.html#"></a></span>
    </div>
    <div class="post-content">
      <h2 id="section">技能点</h2>

<h3 id="git">git</h3>
<ul>
  <li>基本命令</li>
  <li>实现原理</li>
  <li>最佳实践</li>
</ul>

<h3 id="mysql">mysql</h3>
<ul>
  <li>innodb</li>
  <li>锁</li>
  <li>索引</li>
  <li>事务</li>
</ul>

<h3 id="php">php</h3>
<ul>
  <li>php7新特性</li>
  <li>composer</li>
  <li>php扩展</li>
  <li>php内核</li>
  <li>php-fpm</li>
  <li>php框架
    <ul>
      <li>yii</li>
      <li>laravel</li>
      <li>swoole</li>
      <li>yaf</li>
    </ul>
  </li>
</ul>

<h3 id="memcache">memcache</h3>
<ul>
  <li>内存模型</li>
  <li>lru</li>
  <li>一致性hash</li>
</ul>

<h3 id="nginx">nginx</h3>
<ul>
  <li>配置参数</li>
  <li>网络模型</li>
  <li>lua扩展</li>
  <li>调优</li>
</ul>

<h3 id="section-1">网络</h3>
<ul>
  <li>http</li>
  <li>epoll</li>
</ul>

<h3 id="web">web</h3>
<ul>
  <li>session</li>
  <li>cookie</li>
  <li>dns</li>
  <li>负载均衡</li>
</ul>

<h3 id="redis">redis</h3>

<h3 id="docker">docker</h3>

<h3 id="section-2">安全</h3>
<ul>
  <li>sql注入</li>
  <li>xss</li>
  <li>csrf</li>
  <li>文件上传</li>
  <li>文件包含</li>
  <li>放钓鱼</li>
</ul>

<h3 id="section-3">设计模式</h3>
<ul>
  <li>面向对象设计原则</li>
  <li>经典设计模式</li>
  <li>依赖注入</li>
</ul>

<h3 id="section-4">分布式服务</h3>
<ul>
  <li>资源定位、命名服务
    <ul>
      <li>zookeeper</li>
      <li>etcd</li>
    </ul>
  </li>
  <li>mq
    <ul>
      <li>rabbitmq</li>
      <li>kafka</li>
    </ul>
  </li>
  <li>rpc
    <ul>
      <li>thrift</li>
    </ul>
  </li>
  <li>一致性
    <ul>
      <li>两阶段提交</li>
      <li>paxos</li>
      <li>raft</li>
    </ul>
  </li>
</ul>


      <div class="readmore">
        <a href="/skill/2016/08/08/skill_point/"><i class="fa fa-hand-o-right"></i>&nbsp阅读全文</a>
      </div>
    </div>
  </div>
  
  <div class="post">
    <div class="post-heading">
        
          <img src="/public/img/wangxinghu.jpg">
        
      <h1 class="post-title">
        <a class="post-title-home" href="/linux/2016/08/08/servercheck/">
          server_check
        </a>
      </h1>
        <p class="post-info">
        
          wangxinghu原创
        
        </p>
        <span class="post-info"><i class="fa fa-calendar"></i>&nbsp2016/08/08  </span>
        <span class="post-info"><i class="fa fa-book"></i>&nbsp<a href="/category/index.html#linux">linux</a></span>
        <span class="post-info"><i class="fa fa-tags"></i>&nbsp<a href="/tag/index.html#linux">linux</a></span>  
        <span class="post-info"><a href="/tag/index.html#"></a></span>
        <span class="post-info"><a href="/tag/index.html#"></a></span>
    </div>
    <div class="post-content">
      <h3 id="section">应该弄清的问题</h3>

<ul>
  <li>事故的发生时间,持续时间</li>
  <li>事故的表现形式，报错，响应慢，是否有概率出现, 是所有服务全挂了还是仅部分服务有问题</li>
  <li>事故的影响范围是所有用户还是部分用户</li>
  <li>事故是否可稳定重现，是否有规律</li>
  <li>最后几次上线内容</li>
  <li>是否有监控平台可以查看</li>
  <li>是否有日志可以查看</li>
</ul>

<h3 id="cpu">查看cpu内存负载</h3>

<ul>
  <li>free -m</li>
</ul>

<blockquote>
  <pre><code>  free1 + buffers1 + cached1 = free2
  used1 = buffers1 + cached1 + used2
  实际看第二行的free
  share 共享内存
</code></pre>
</blockquote>

<ul>
  <li>uptime</li>
</ul>

<blockquote>
  <pre><code>  负载1min, 5min, 15min
  系统运行了多长时间
</code></pre>
</blockquote>

<ul>
  <li>top</li>
</ul>

<blockquote>
  <pre><code>  F:选择排序的列
  F:选择排序的列
  R:倒排
  &lt;&gt;:翻页
  f:选择显示的列
  o:改变显示的顺序
</code></pre>
</blockquote>

<h3 id="section-1">查看系统报错信息</h3>
<ul>
  <li>dmesg
    <ul>
      <li>查看系统日志，老版本不显示时间？</li>
    </ul>
  </li>
  <li>less /var/log/messages</li>
  <li>less /var/log/secure</li>
  <li>less /var/log/auth</li>
  <li>sar
    <ul>
      <li>sar -n TCP,ETCP 1
        <ul>
          <li>查看tcp连接状态</li>
          <li>active/s:每秒本地发起的tcp连接数,即通过connect调用创建的tcp连接</li>
          <li>passive/s:每秒远程发起的tcp连接数,即通过accept调用创建的tcp连接</li>
          <li>retrans/s:每秒tcp重传数量</li>
        </ul>
      </li>
      <li>sar -n DEV 1
        <ul>
          <li>查看网络设备的吞吐率</li>
        </ul>
      </li>
      <li>sar -d 10 3: 10s一次，采样3次，统计设备使用信息</li>
    </ul>
  </li>
</ul>

<blockquote>
  <pre><code>   -b：报告I/O使用情况以及传输速率。（只适用于2.5及之前的内核，所以新内核有可能不支持这个选项）
   -B：报告“页”使用情况
   -c：报告进程创建情况
   -d：报告每一个块设备的使用情况
   （当你使用时，你会发现在DEV列有类似dev1-7格式的字符串，
   其中1代表设备的主序号，n代表设备的从序号，
   而且rd_sec/s列和wr_sec/s列的单位都是512bytes，也就是512B，也就是0.5KB）
   -I：汇报中断情况
   -n：汇报网络情况TCP ETCP DEV EDEV SOCK FULL
   -P：设定CPU
   -q：汇报队列长度和负载信息
   -r：汇报内存和交换区使用情况
   -R：汇报内存情况
   -u：汇报CPU使用情况
   -v：汇报i节点、文件和其他内核表信息
   -w：汇报系统上下文切换情况
   -x：可以针对某个特定PID给出统计信息，
   可以直接指定进程ID号；
   也可以指定为SELF，这样就是检测sar进程本身；
   如果设定为ALL，则表示汇报所有系统进程信息。
   -X：汇报特定PID的子进程的信息
   -y：设定TTY设备的信息。

  怀疑CPU存在瓶颈，可用 sar -u 和 sar -q 等来查看
  怀疑内存存在瓶颈，可用 sar -B、sar -r 和 sar -W 等来查看
  怀疑I/O存在瓶颈，可用 sar -b、sar -u 和 sar -d 等来查看
</code></pre>
</blockquote>

<h3 id="section-2">查看运行的进程</h3>

<ul>
  <li>pstree -a</li>
  <li>ps aux</li>
  <li>lsof</li>
</ul>

<blockquote>
  <pre><code>  lsof  filename 显示打开指定文件的所有进程
  lsof -a 表示两个参数都必须满足时才显示结果
  lsof -c string   显示COMMAND列中包含指定字符的进程所有打开的文件
  lsof -u username  显示所属user进程打开的文件
  lsof -g gid 显示归属gid的进程情况
  lsof +d /DIR/ 显示目录下被进程打开的文件
  lsof +D /DIR/ 同上，但是会搜索目录下的所有目录，时间相对较长
  lsof -d FD 显示指定文件描述符的进程
  lsof -n 不将IP转换为hostname，缺省是不加上-n参数
  lsof -i 用以显示符合条件的进程情况
  lsof -i[46] [protocol][@hostname|hostaddr][:service|port]
           46 --&gt; IPv4 or IPv6
           protocol --&gt; TCP or UDP
           hostname --&gt; Internet host name
           hostaddr --&gt; IPv4地址
           service --&gt; /etc/service中的 service name (可以不只一个)
           port --&gt; 端口号 (可以不只一个)
</code></pre>
</blockquote>

<h3 id="section-3">监听的网络服务</h3>

<ul>
  <li>netstat -nltp</li>
  <li>netstat -nutp</li>
  <li>netstat -nxtp</li>
</ul>

<blockquote>
  <pre><code>  -a (all)显示所有选项，默认不显示LISTEN相关
  -t (tcp)仅显示tcp相关选项
  -u (udp)仅显示udp相关选项
  -n 拒绝显示别名，能显示数字的全部转化成数字。
  -l 仅列出有在 Listen (监听) 的服務状态
  -i 列出网络接口列表
  -p 显示建立相关链接的程序名
  -r 显示路由信息，路由表
  -e 显示扩展信息，例如uid等
  -s 按各个协议进行统计
  -c 每隔一个固定时间，执行该netstat命令。

  提示：LISTEN和LISTENING的状态只有用-a或者-l才能看到
</code></pre>
</blockquote>

<ul>
  <li>ss -s</li>
</ul>

<blockquote>
  <pre><code>  -n, 不解析服务名称
  -r, 解析主机名
  -a, 显示所有套接字（sockets）
  -l, 显示监听状态的套接字（sockets）
  -o, 显示计时器信息
  -e, 显示详细的套接字（sockets）信息
  -m, 显示套接字（socket）的内存使用情况
  -p, 显示使用套接字（socket）的进程
  -i, 显示 TCP内部信息
  -s, 显示套接字（socket）使用概况
  -4, 仅显示IPv4的套接字（sockets）
  -6, 仅显示IPv6的套接字（sockets）
  -0, 显示 PACKET 套接字（socket）
  -t, 仅显示 TCP套接字（sockets）
  -u, 仅显示 UCP套接字（sockets）
  -d, 仅显示 DCCP套接字（sockets）
  -w, 仅显示 RAW套接字（sockets）
  -x, 仅显示 Unix套接字（sockets）
  -f, -f=FAMILY  显示 FAMILY类型的套接字（sockets），FAMILY可选，支持  unix, inet, inet6, link, netlink
  -A, QUERY := {all|inet|tcp|udp|raw|unix|packet|netlink}[,QUERY]
  -D, -D=FILE     将原始TCP套接字（sockets）信息转储到文件
  -F, -F=FILE   从文件中都去过滤器信息
         FILTER := [ state TCP-STATE ] [ EXPRESSION ]
</code></pre>
</blockquote>

<ul>
  <li>tcpdump</li>
</ul>

<blockquote>
  <pre><code>  tcpdump [ -adeflnNOpqStvx ] [ -c 数量 ] [ -F 文件名 ]
  [ -i 网络接口 ] [ -r 文件名] [ -s snaplen ]
  [ -T 类型 ] [ -w 文件名 ] [表达式 ]
  1. tcpdump的选项介绍
  -a 　将网络地址和广播地址转变成名字；
  -d 　将匹配信息包的代码以人们能够理解的汇编格式给出；
  -dd 　将匹配信息包的代码以c语言程序段的格式给出；
  -ddd 　将匹配信息包的代码以十进制的形式给出；
  -e 　在输出行打印出数据链路层的头部信息；
  -f 　将外部的Internet地址以数字的形式打印出来；
  -l 　使标准输出变为缓冲行形式；
  -n 　不把网络地址转换成名字；
  -t 　在输出的每一行不打印时间戳；
  -v 　输出一个稍微详细的信息，例如在ip包中可以包括ttl和服务类型的信息；
  -vv 　输出详细的报文信息；
  -c 　在收到指定的包的数目后，tcpdump就会停止；
  -F 　从指定的文件中读取表达式,忽略其它的表达式；
  -i 　指定监听的网络接口；
  -r 　从指定的文件中读取包(这些包一般通过-w选项产生)；
  -w 　直接将包写入文件中，并不分析和打印出来；
  -T 　将监听到的包直接解释为指定的类型的报文，常见的类型有rpc 
</code></pre>
</blockquote>

<ul>
  <li>wireshark</li>
  <li>watch</li>
</ul>

<h3 id="section-4">网络连接</h3>
<ul>
  <li>traceroute</li>
  <li>nslookup</li>
</ul>

<h3 id="io">io性能</h3>
<ul>
  <li>iostat -kx 2</li>
</ul>

<blockquote>
  <pre><code>   -c 仅显示CPU统计信息.与-d选项互斥.
   -d 仅显示磁盘统计信息.与-c选项互斥.
   -k 以K为单位显示每秒的磁盘请求数,默认单位块.
   -p device | ALL
    与-x选项互斥,用于显示块设备及系统分区的统计信息.也可以在-p后指定一个设备名,如:
    # iostat -p hda
    或显示所有设备
    # iostat -p ALL
   -t    在输出数据时,打印搜集数据的时间.
   -V    打印版本号和帮助信息.
   -x    输出扩展信息
</code></pre>
</blockquote>

<ul>
  <li>vmstat 2 10</li>
</ul>

<blockquote>
  <pre><code>  -a：显示活跃和非活跃内存
  -f：显示从系统启动至今的fork数量 。
  -m：显示slabinfo
  -n：只在开始时显示一次各字段名称。
  -s：显示内存相关统计信息及多种系统活动数量。
  delay：刷新时间间隔。如果不指定，只显示一条结果。
  count：刷新次数。如果不指定刷新次数，但指定了刷新时间间隔，这时刷新次数为无穷。
  -d：显示磁盘相关统计信息。
  -p：显示指定磁盘分区统计信息
  -S：使用指定单位显示。参数有 k 、K 、m 、M ，分别代表1000、1024、1000000、1048576字节（byte）。默认单位为K（1024 bytes）
  -V：显示vmstat版本信息。
</code></pre>
</blockquote>

<ul>
  <li>mpstat 2 10
    <ul>
      <li>mpstat -P ALL 5 2  显示所有cpu统计信息</li>
    </ul>
  </li>
  <li>pidstat
    <ul>
      <li>pidstat -r -p 123 1 显示进程占用系统资源的情况</li>
    </ul>
  </li>
  <li>dstat –top-io –top-bio</li>
</ul>

<blockquote>
  <pre><code>  -l ：显示负载统计量
  -m ：显示内存使用率（包括used，buffer，cache，free值）
  -r ：显示I/O统计
  -s ：显示交换分区使用情况
  -t ：将当前时间显示在第一行
  –fs ：显示文件系统统计数据（包括文件总数量和inodes值）
  –nocolor ：不显示颜色（有时候有用）
  –socket ：显示网络统计数据
  –tcp ：显示常用的TCP统计
  –udp ：显示监听的UDP接口及其当前用量的一些动态数据
  当然不止这些用法，dstat附带了一些插件很大程度地扩展了它的功能。你可以通过查看/usr/share/dstat目录来查看它们的一些使用方法，常用的有这些：

  -–disk-util ：显示某一时间磁盘的忙碌状况
  -–freespace ：显示当前磁盘空间使用率
  -–proc-count ：显示正在运行的程序数量
  -–top-bio ：指出块I/O最大的进程
  -–top-cpu ：图形化显示CPU占用最大的进程
  -–top-io ：显示正常I/O最大的进程
  -–top-mem ：显示占用最多内存的进程
</code></pre>
</blockquote>

<h3 id="section-5">硬件</h3>
<ul>
  <li>lspci</li>
  <li>dmidecode</li>
  <li>ethtool</li>
  <li>df -h</li>
</ul>

<h3 id="section-6">定时任务</h3>
<ul>
  <li>ls /etc/cron* + cat</li>
</ul>

<h3 id="section-7">应用系统日志</h3>
<ul>
  <li>nginx
    <ul>
      <li>error_log</li>
      <li>access_log</li>
    </ul>
  </li>
  <li>php-fpm
    <ul>
      <li>error_log</li>
      <li>slow.log</li>
    </ul>
  </li>
  <li>mysql
    <ul>
      <li>show processlist
  _ mysql.log</li>
    </ul>
  </li>
  <li>app.log</li>
</ul>

<h3 id="section-8">进程调试</h3>
<ul>
  <li>gdb</li>
  <li>cat /proc/</li>
  <li>strace</li>
</ul>

<blockquote>
  <pre><code>  -c 统计每一系统调用的所执行的时间,次数和出错的次数等.
  -d 输出strace关于标准错误的调试信息.
  -f 跟踪由fork调用所产生的子进程.
  -ff 如果提供-o filename,则所有进程的跟踪结果输出到相应的filename.pid中,pid是各进程的进程号.
  -F 尝试跟踪vfork调用.在-f时,vfork不被跟踪.
  -h 输出简要的帮助信息.
  -i 输出系统调用的入口指针.
  -q 禁止输出关于脱离的消息.
  -r 打印出相对时间关于,,每一个系统调用.
  -t 在输出中的每一行前加上时间信息.
  -tt 在输出中的每一行前加上时间信息,微秒级.
  -ttt 微秒级输出,以秒了表示时间.
  -T 显示每一调用所耗的时间.
  -v 输出所有的系统调用.一些调用关于环境变量,状态,输入输出等调用由于使用频繁,默认不输出.
  -V 输出strace的版本信息.
  -x 以十六进制形式输出非标准字符串
  -xx 所有字符串以十六进制形式输出.
  -a column
  设置返回值的输出位置.默认 为40.
  -e expr
  指定一个表达式,用来控制如何跟踪.格式如下:
  [qualifier=][!]value1[,value2]...
  qualifier只能是 trace,abbrev,verbose,raw,signal,read,write其中之一.value是用来限定的符号或数字.默认的 qualifier是 trace.感叹号是否定符号.例如:
  -eopen等价于 -e trace=open,表示只跟踪open调用.而-etrace!=open表示跟踪除了open以外的其他调用.有两个特殊的符号 all 和 none.
  注意有些shell使用!来执行历史记录里的命令,所以要使用\\.
  -e trace=set
  只跟踪指定的系统 调用.例如:-e trace=open,close,rean,write表示只跟踪这四个系统调用.默认的为set=all.
  -e trace=file
  只跟踪有关文件操作的系统调用.
  -e trace=process
  只跟踪有关进程控制的系统调用.
  -e trace=network
  跟踪与网络有关的所有系统调用.
  -e strace=signal
  跟踪所有与系统信号有关的 系统调用
  -e trace=ipc
  跟踪所有与进程通讯有关的系统调用
  -e abbrev=set
  设定 strace输出的系统调用的结果集.-v 等与 abbrev=none.默认为abbrev=all.
  -e raw=set
  将指 定的系统调用的参数以十六进制显示.
  -e signal=set
  指定跟踪的系统信号.默认为all.如 signal=!SIGIO(或者signal=!io),表示不跟踪SIGIO信号.
  -e read=set
  输出从指定文件中读出 的数据.例如:
  -e read=3,5
  -e write=set
  输出写入到指定文件中的数据.
  -o filename
  将strace的输出写入文件filename
  -p pid
  跟踪指定的进程pid.
  -s strsize
  指定输出的字符串的最大长度.默认为32.文件名一直全部输出.
  -u username
  以username 的UID和GID执行被跟踪的命令
</code></pre>
</blockquote>

<ul>
  <li>ltrace</li>
  <li>dtruss</li>
</ul>


      <div class="readmore">
        <a href="/linux/2016/08/08/servercheck/"><i class="fa fa-hand-o-right"></i>&nbsp阅读全文</a>
      </div>
    </div>
  </div>
  
  <div class="post">
    <div class="post-heading">
        
          <img src="/public/img/wangxinghu.jpg">
        
      <h1 class="post-title">
        <a class="post-title-home" href="/php/2016/07/27/php%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/">
          编码问题
        </a>
      </h1>
        <p class="post-info">
        
          wangxinghu原创
        
        </p>
        <span class="post-info"><i class="fa fa-calendar"></i>&nbsp2016/07/27  </span>
        <span class="post-info"><i class="fa fa-book"></i>&nbsp<a href="/category/index.html#php">php</a></span>
        <span class="post-info"><i class="fa fa-tags"></i>&nbsp<a href="/tag/index.html#php">php</a></span>  
        <span class="post-info"><a href="/tag/index.html#编码">编码</a></span>
        <span class="post-info"><a href="/tag/index.html#"></a></span>
    </div>
    <div class="post-content">
      <h3 id="section">现象</h3>
<p>有一个发短信的服务，在手机上收到的内容和预期的不一致，空格变成了？。查看数据库和日志都是正常的显示空格。怀疑是字符编码问题，因为数据库和应用的字符集都是utf-8，调用第三方短信通道时被要求转为GBK，既然有思路就上代码复现。</p>

<h3 id="section-1">代码复现</h3>

<pre><code class="language-php">    $message1 = '点击网址 马上报名！';
    $message2 = '点击网址 马上报名！';//\u00a0
    var_dump(json_encode($message1));
    var_dump(json_encode($message2));
</code></pre>

<p>输出如下：</p>

<blockquote>
  <p>string(57) ““\u70b9\u51fb\u7f51\u5740 \u9a6c\u4e0a\u62a5\u540d\uff01””</p>

  <p>string(62) ““\u70b9\u51fb\u7f51\u5740\u00a0\u9a6c\u4e0a\u62a5\u540d\uff01””</p>
</blockquote>

<p>发现<code>message2</code>里的空格的<strong>unicode</strong>字符是<strong>\u00a0</strong>，而<strong>GBK</strong>编码中不存在这个字符。
<strong>\u00a0</strong>被称为不间断空格<strong>NO-BREAK SPACE</strong>，常见于html中。</p>

<h3 id="section-2">解决</h3>
<p>既然GBK不识别，就需要过滤掉这种非法字符</p>

<pre><code class="language-php">    $content = str_replace(chr(194) . chr(160), " ", $content);
</code></pre>

      <div class="readmore">
        <a href="/php/2016/07/27/php%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/"><i class="fa fa-hand-o-right"></i>&nbsp阅读全文</a>
      </div>
    </div>
  </div>
  
  <div class="post">
    <div class="post-heading">
        
          <img src="/public/img/wangxinghu.jpg">
        
      <h1 class="post-title">
        <a class="post-title-home" href="/jekyll/2016/07/27/jekyll_install/">
          jekyll
        </a>
      </h1>
        <p class="post-info">
        
          wangxinghu原创
        
        </p>
        <span class="post-info"><i class="fa fa-calendar"></i>&nbsp2016/07/27  </span>
        <span class="post-info"><i class="fa fa-book"></i>&nbsp<a href="/category/index.html#jekyll">jekyll</a></span>
        <span class="post-info"><i class="fa fa-tags"></i>&nbsp<a href="/tag/index.html#学习">学习</a></span>  
        <span class="post-info"><a href="/tag/index.html#"></a></span>
        <span class="post-info"><a href="/tag/index.html#"></a></span>
    </div>
    <div class="post-content">
      <h3 id="jekyll-install">jekyll install</h3>

<ul>
  <li>install ruby</li>
  <li>install jekyll
    <ul>
      <li>gem install jekyll</li>
      <li>gem install jekyll-paginate</li>
      <li>gem install rdiscount</li>
      <li>gem install rouge</li>
      <li>rougify style monokai.sublime &gt; rouge.css</li>
    </ul>
  </li>
  <li>start server
    <ul>
      <li>jekyll build</li>
      <li>jekyll serve</li>
    </ul>
  </li>
</ul>

      <div class="readmore">
        <a href="/jekyll/2016/07/27/jekyll_install/"><i class="fa fa-hand-o-right"></i>&nbsp阅读全文</a>
      </div>
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item newer">已经是最新的博文</span>
  

  
    <a class="pagination-item older" href="/page2">更早的博文</a>
  
</div>


      </div>
    </div>
    
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    <div class="footer">
  <p>  Copyright © 2016 - <a href="/">tiger</a> - Powered by 
    <a href="http://jekyllrb.com/">Jekyll</a>.
    <a href="http://github.com/">Github</a>
  </p>
  <ul>
    <li><a href="https://github.com/xinghuwang"><i class="fa fa-github fa-2x"></i></a></li>
  </ul>
</div>


    <!-- "The ending isn’t any more important than the moments leading to it." -Dr. Eva Rosalene, To The Moon -->
  </body>
</html>
